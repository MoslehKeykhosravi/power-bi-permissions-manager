# ردیابی ممیزی دسترسی و گزارش‌های انطباق

## معرفی ویژگی

یک لایه کش برای مجوزهای فعلی پیاده‌سازی کنید که وضعیت به‌روز دسترسی گزارش‌ها و پوشه‌ها را برای هر کاربر و گروه نگه می‌دارد. بک‌اند در هر فراخوانی API (یا همگام‌سازی زمان‌بندی‌شده) آخرین مجوزها را نرمال‌سازی کرده، آن‌ها را در یک ذخیره‌ساز سریع ثبت می‌کند و مسیرهای فوری برای بازیابی فراهم می‌سازد تا مدیران بدون انتظار برای واکشی تازه از Power BI Report Server بفهمند «همین حالا چه کسی به چه چیزی دسترسی دارد».

## چرا پروژه را بهبود می‌دهد

- نیاز به پرس‌وجوهای مکرر از Report Server برای پاسخ به پرسش «کاربر X به گزارش Y دسترسی دارد؟» را حذف می‌کند و رابط را در محیط‌های بزرگ سریع نگه می‌دارد.
- یک منبع حقیقت واحد برای مجوزهای فعلی فراهم می‌کند و عیب‌یابی و پاسخ‌گویی به درخواست‌های پشتیبانی را ساده‌تر می‌سازد.
- نماهای متمرکز بر کاربر و مقایسه‌ها را ممکن می‌کند (مثلاً نمایش تمام گزارش‌ها و پوشه‌هایی که یک کاربر یا گروه به آن‌ها دسترسی دارد یا اطمینان از اینکه کاربر تازه اضافه‌شده نقش‌های صحیح را گرفته است).
- پایه‌ای برای قابلیت‌های آینده (مانند شناسایی انحراف) فراهم می‌کند درحالی‌که برای تیم‌هایی که فقط به وضعیت لحظه‌ای نیاز دارند سبک و کم‌هزینه می‌ماند.

## ارزیابی مفید بودن

- **اثرگذاری:** زیاد برای عملیات روزمره. مدیران می‌توانند در چند ثانیه دسترسی را تأیید کنند و فرایندهای ورود، خروج و پاسخ‌گویی به تیکت‌ها را سرعت دهند.
- **هزینه اجرایی:** متوسط. نیازمند افزودن لایه کش، گسترش مسیرهای بک‌اند و اضافه‌کردن پنل جدید در فرانت‌اند است، اما از ذخیره‌سازی تاریخی طولانی‌مدت پرهیز می‌کند.
- **تمایز:** قابل توجه. بسیاری از ابزارهای Power BI مجوزها را مدیریت می‌کنند اما برای اعتبارسنجی همچنان به پرس‌وجوی زنده متکی‌اند؛ پاسخ‌های فوری مزیت بهره‌وری محسوسی ایجاد می‌کند.

## نقشه راه پیاده‌سازی

1. **معماری و برنامه‌ریزی**
   - فناوری کش را انتخاب کنید: Redis برای پاسخ‌های بسیار سریع یا جدول رابطه‌ای (مانند SQLite/PostgreSQL) برای سادگی استقرار.
   - شِماهای جداول `current_user_permissions` و `current_item_permissions` را با ایندکس‌های کاربر، گروه، مسیر و نقش تعریف کنید.
   - تنظیمات محیطی و Docker Compose را برای راه‌اندازی سرویس انتخابی گسترش دهید.
2. **زیربنای بک‌اند**
   - لایه دسترسی به داده را برای خواندن/نوشتن سریع در کش اضافه کنید.
   - مسیرهای موجود `/api/permissions` را طوری به‌روزرسانی کنید که هنگام تنظیم یا واکشی مجوزها، وضعیت تازه را در کش ثبت کنند.
   - مسیرهای جدید `/api/permissions/user/:principalId` و `/api/permissions/item/:itemId` را اضافه کنید تا مستقیماً از کش پاسخ دهند.
   - یک مسیر «به‌روزرسانی از منبع» و در صورت نیاز کار زمان‌بندی‌شده برای همگام‌سازی با Report Server پیاده‌سازی کنید.
3. **تجربه فرانت‌اند**
   - یک پنل جدید Vue بسازید که به مدیران اجازه دهد کاربر یا گروه را جست‌وجو کرده و فوراً تمام پوشه‌ها و گزارش‌های قابل دسترس را ببیند.
   - فیلترهای سریع (بر اساس نقش یا نوع مورد) و اقدامات ساده برای پرش به مورد یا کپی نتایج اضافه کنید.
   - وضعیت‌های بارگذاری/خطا و اطلاعات آخرین زمان به‌روزرسانی را نمایش دهید.
4. **پایش و ایمنی**
   - خطاهای کش و مدت‌زمان همگام‌سازی را لاگ کنید تا اطمینان حاصل شود سیستم با Report Server هماهنگ می‌ماند.
   - هشدارهای ساده (مثلاً پیام یا لاگ) در صورت قدیمی شدن داده‌های کش یا شکست همگام‌سازی فراهم کنید.
5. **آزمون و ارزیابی**
   - تست‌های واحد برای عملیات کش و مسیرهای جدید بنویسید.
   - تست‌های یکپارچه اضافه کنید تا مطمئن شوید تغییرات مجوز فوراً در کش و رابط کاربری منعکس می‌شوند.
   - روتین‌های همگام‌سازی را با حجم داده نماینده آزمایش کنید تا عملکرد مطلوب تأیید شود.
6. **مستندسازی و انتشار**
   - راهنماهای راه‌اندازی را با پیکربندی کش و متغیرهای محیطی جدید به‌روزرسانی کنید.
   - جریان‌های کاری مدیران برای به‌روزرسانی و تأیید مجوزها را مستند کنید.
   - قابلیت پاسخ‌گویی سریع به درخواست‌های دسترسی را در یادداشت‌های انتشار و دستورالعمل‌های ورود به سیستم برجسته کنید.

